import{j as t,R as y,f as U,e as J,r as F}from"./index-CpqSmuqB.js";import{u as C,a as j,b as H,r as z,d as G,e as x,g as A,s as M,h as R,i as K,j as X}from"./formSlice-rzx5E_LX.js";import{T as Y}from"./ThemeToggle-DbCPRthF.js";import{f as E}from"./formTemplates-uoGO9qH-.js";const W=[{id:"short-answer",label:"Short answer"},{id:"paragraph",label:"Paragraph"},{id:"multiple-choice",label:"Multiple Choice"},{id:"checkboxes",label:"Checkboxes"},{id:"dropdown",label:"Drop-down"},{id:"date",label:"Date"},{id:"radio",label:"Radio"}];function Z({title:e,type:r,onTitleChange:n,onTypeChange:a,onRemove:s}){return t.jsx("div",{className:"flex items-start justify-between mb-4",children:t.jsxs("div",{className:"flex-1 mr-4",children:[t.jsx("input",{type:"text",value:e||"",onChange:n,placeholder:"Question Title",className:"w-full text-lg font-semibold mb-2 p-2 border-b-2 border-transparent focus:border-blue-500 focus:outline-none bg-transparent dark:text-white transition-colors"}),t.jsx("select",{value:r,onChange:a,className:"text-sm px-3 py-1.5 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:W.map(l=>t.jsx("option",{value:l.id,children:l.label},l.id))})]})})}function ee(){return t.jsx("div",{children:W.map(e=>t.jsx("div",{draggable:!0,className:`bg-blue-100 dark:bg-blue-900 hover:bg-blue-200 dark:hover:bg-blue-800 \r
                     text-blue-800 dark:text-blue-100 font-semibold py-2 px-4 rounded-md mb-2 \r
                     cursor-grab transition-colors shadow-sm hover:shadow-md`,onDragStart:r=>{r.dataTransfer.setData("fieldType",e.id)},children:e.label},e.id))})}var _={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},$=y.createContext&&y.createContext(_),te=["attr","size","title"];function re(e,r){if(e==null)return{};var n=ne(e,r),a,s;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)a=l[s],!(r.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function ne(e,r){if(e==null)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(r.indexOf(a)>=0)continue;n[a]=e[a]}return n}function O(){return O=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},O.apply(this,arguments)}function q(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,a)}return n}function D(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?q(Object(n),!0).forEach(function(a){oe(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function oe(e,r,n){return r=ae(r),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function ae(e){var r=se(e,"string");return typeof r=="symbol"?r:r+""}function se(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function B(e){return e&&e.map((r,n)=>y.createElement(r.tag,D({key:n},r.attr),B(r.child)))}function V(e){return r=>y.createElement(ie,O({attr:D({},e.attr)},r),B(e.child))}function ie(e){var r=n=>{var{attr:a,size:s,title:l}=e,c=re(e,te),m=s||n.size||"1em",p;return n.className&&(p=n.className),e.className&&(p=(p?p+" ":"")+e.className),y.createElement("svg",O({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,a,c,{className:p,style:D(D({color:e.color||n.color},n.style),e.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),l&&y.createElement("title",null,l),e.children)};return $!==void 0?y.createElement($.Consumer,null,n=>r(n)):r(_)}function le(e){return V({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"m176 112 80-80 80 80m-80.02-80 .02 448m-80-80 80 80 80-80m64-224 80 80-80 80M112 176l-80 80 80 80m-80-80h448"},child:[]}]})(e)}function de(e){return V({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"m112 112 20 320c.95 18.49 14.4 32 32 32h184c17.67 0 30.87-13.51 32-32l20-320"},child:[]},{tag:"path",attr:{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"32",d:"M80 112h352"},child:[]},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M192 112V72h0a23.93 23.93 0 0 1 24-24h80a23.93 23.93 0 0 1 24 24h0v40m-64 64v224m-72-224 8 224m136-224-8 224"},child:[]}]})(e)}function ce({questionId:e,optionId:r,type:n}){const a=C(),s=j(p=>{const f=p.form.questions.find(b=>b.id===e);return f?f.options.find(b=>b.id===r):null});if(!s)return null;const l=p=>{a(H({questionId:e,updatedOption:{...s,text:p.target.value}}))},c=()=>{a(z({questionId:e,optionIdToRemove:s.id}))},m=n==="multiple-choice"?"radio":"checkbox";return t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("input",{type:m,className:"mr-2 h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500",disabled:!0}),t.jsx("input",{type:"text",className:"flex-grow p-2 border-b border-gray-300 focus:border-blue-500 outline-none text-gray-800 mr-2",value:s.text,onChange:l,placeholder:`Option ${s.text}`}),n!=="dropdown"&&n!=="radio"&&s.text!=="Option 1"&&t.jsx("button",{onClick:c,className:"text-gray-500 hover:text-red-600 p-1 rounded-full hover:bg-gray-100 transition-colors"})]})}function ue({question:e}){const r=C();if(!e)return null;const{id:n,type:a,options:s=[]}=e,l=()=>{const c={id:`opt-${Date.now()}-${Math.random()}`,text:`Option ${s.length+1}`};r(G({questionId:n,newOption:c}))};return t.jsxs("div",{className:"space-y-2 mt-2",children:[s.map(c=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full border border-gray-400 dark:border-gray-500 flex-shrink-0"}),t.jsx(ce,{questionId:n,optionId:c.id,type:a}),t.jsx("button",{onClick:()=>r(z({questionId:n,optionIdToRemove:c.id})),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors","aria-label":"Remove option",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},c.id)),t.jsxs("button",{onClick:l,className:"mt-2 text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors",children:[t.jsx("span",{className:"mr-2 text-xl",children:"+"})," Add option"]})]})}function ge({question:e,onUpdate:r}){const n=["multiple-choice","checkboxes","dropdown","radio"].includes(e.type);return t.jsxs("div",{className:"mb-4",children:["      ",n?t.jsx(ue,{question:e}):t.jsx("div",{className:"mt-2",children:t.jsx("input",{type:e.type==="date"?"date":"text",disabled:!0,placeholder:e.type==="short-answer"?"Short answer text":e.type==="paragraph"?"Long answer text":"Answer",className:"w-full p-2 border border-gray-300  rounded-md bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed transition-colors"})})]})}function me({questionId:e,required:r,onRequiredToggle:n,onDeleteQuestion:a}){return t.jsxs("div",{className:"border-t border-gray-200 pt-4 flex justify-end items-center dark:border-gray-700",children:[t.jsxs("label",{className:"flex items-center cursor-pointer mr-4",children:[t.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-blue-600 dark:text-blue-500 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500 transition-colors",checked:r,onChange:n}),t.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300",children:"Required"})]}),t.jsx("button",{onClick:()=>a(e),className:"text-gray-500 hover:text-red-600 p-2 rounded-full hover:bg-gray-100 transition-colors",children:t.jsx(de,{size:22})})]})}const pe=[{label:"None",value:""},{label:"Email Address",value:"^\\S+@\\S+\\.\\S+$"},{label:"10-digit Mobile Number (India)",value:"^[6-9]\\d{9}$"}];function he({type:e,minLength:r,maxLength:n,pattern:a,onMinLengthChange:s,onMaxLengthChange:l,onPatternChange:c,onStandardPatternSelect:m}){const p=e==="short-answer"||e==="paragraph",f=e==="short-answer";return!p&&!f?null:t.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-md border border-gray-200 dark:bg-gray-800 dark:border-gray-700",children:[t.jsx("h4",{className:"text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300",children:"Validation Rules"}),p&&t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400 w-24",children:"Min Length:"}),t.jsx("input",{type:"number",className:`ml-2 w-20 p-1 border border-gray-300 dark:border-gray-600 rounded \r
                          bg-white dark:bg-gray-700 text-gray-900 dark:text-white \r
                          focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors`,value:r===void 0?"":r,onChange:s,min:"0"}),t.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400 w-24 ml-4",children:"Max Length:"}),t.jsx("input",{type:"number",className:`ml-2 w-20 p-1 border border-gray-300 dark:border-gray-600 rounded \r
                          bg-white dark:bg-gray-700 text-gray-900 dark:text-white \r
                          focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors`,value:n===void 0?"":n,onChange:l,min:"0"})]}),f&&t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Standard Patterns:"}),t.jsx("select",{className:"block appearance-none w-full bg-white border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-white py-2 px-3 pr-8 rounded-md leading-tight focus:outline-none focus:bg-white focus:border-blue-500 mb-2",value:a||"",onChange:m,children:pe.map(b=>t.jsx("option",{value:b.value,children:b.label},b.label))}),t.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Custom Pattern (Regex):"}),t.jsx("input",{type:"text",className:"flex-grow p-1 border border-gray-300 dark:border-gray-600 rounded-md focus:border-blue-500 outline-none text-gray-700 dark:text-white bg-white dark:bg-gray-700",value:a||"",onChange:c,placeholder:"e.g., ^\\\\S+@\\\\S+\\\\.\\\\S+$ for email"})]})]})}function fe({questionId:e,onDragStart:r,onDragOver:n,onDrop:a,index:s}){const l=C(),c=j(i=>i.form.questions.find(u=>u.id===e));if(!c)return null;const{id:m,title:p,type:f,required:b,options:k=[],minLength:S,maxLength:I,pattern:T}=c,N=i=>{l(x({...c,title:i.target.value}))},P=i=>{const u=i.target.value,v=u==="multiple-choice"||u==="checkboxes"||u==="dropdown"||u==="radio"?k.length>0?k:[{id:`opt-${Date.now()}-1`,text:"Option 1"}]:[],w={...c,type:u,options:v};u!=="short-answer"&&u!=="paragraph"&&(delete w.minLength,delete w.maxLength),u!=="short-answer"&&delete w.pattern,l(x(w))},Q=()=>{l(x({...c,required:!b}))},L=()=>{l(A(m))},o=i=>{const u=i.target.value===""?void 0:parseInt(i.target.value,10);l(x({...c,minLength:u}))},d=i=>{const u=i.target.value===""?void 0:parseInt(i.target.value,10);l(x({...c,maxLength:u}))},g=i=>{l(x({...c,pattern:i.target.value}))},h=i=>{const u=i.target.value;l(x({...c,pattern:u}))};return t.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6 mb-4 border border-gray-300 relative group",draggable:!0,onDragStart:i=>r(i,s),onDragOver:i=>n(i,s),onDrop:i=>a(i,s),children:[t.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 bg-gray-200 rounded-full p-1 cursor-grab opacity-0 group-hover:opacity-100 transition-opacity z-10",children:t.jsx(le,{size:18,className:"text-gray-600"})}),t.jsx(Z,{title:p,type:f,onTitleChange:N,onTypeChange:P}),t.jsx(ge,{question:c}),t.jsx(he,{type:f,minLength:S,maxLength:I,pattern:T,onMinLengthChange:o,onMaxLengthChange:d,onPatternChange:g,onStandardPatternSelect:h}),t.jsx(me,{questionId:m,required:b,onRequiredToggle:Q,onDeleteQuestion:L})]})}function be({onDragOver:e,onDrop:r,onQuestionDragStart:n,onQuestionDragOver:a,onQuestionDrop:s}){const l=j(c=>c.form.questions);return t.jsx("div",{className:"min-h-96 border-2 border-dashed border-gray-300 rounded-lg p-4 bg-gray-50 dark:border-gray-600 dark:bg-gray-800",onDragOver:e,onDrop:r,children:l.length===0?t.jsx("p",{className:"text-gray-500 text-center py-10 dark:text-gray-400",children:"Drag and drop form fields here to add questions"}):l.map((c,m)=>t.jsx(fe,{questionId:c.id,index:m,onDragStart:n,onDragOver:a,onDrop:s},c.id))})}function je({formId:e}){const r=j(o=>o.form.title),n=j(o=>o.form.description),a=j(o=>o.form.questions),s=C(),l=U(),c=J(),m=e||c.formId,p=F.useRef(null),f=F.useRef(null);F.useEffect(()=>{if(m){const d=JSON.parse(localStorage.getItem("forms")||"[]").find(g=>g.id===m);if(d){if(d.isTemplate&&d.originalTemplate){const g=E[d.originalTemplate];if(g){g.fields.map(u=>u.id);const h=d.fields.map(u=>u.id),i=g.fields.filter(u=>!h.includes(u.id));i.length>0&&(d.fields=[...i,...d.fields])}}s(M(d))}else console.warn(`Form with ID ${m} not found. Navigating to new form.`),l("/form-builder")}else s(M({title:"Untitled form",description:"",fields:[]}))},[m,l,s]);const b=o=>{o.preventDefault()},k=o=>{o.preventDefault();const d=o.dataTransfer.getData("fieldType");d&&s(K({id:`q-${Date.now()}-${Math.random()}`,title:"Untitled Question",type:d,required:!1,options:d==="multiple-choice"||d==="checkboxes"||d==="dropdown"||d==="radio"?[{id:`opt-${Date.now()}-1`,text:"Option 1"}]:[]}))},S=(o,d)=>{p.current=d,o.dataTransfer.effectAllowed="move"},I=(o,d)=>{o.preventDefault(),f.current=d},T=(o,d)=>{o.preventDefault();const g=p.current,h=f.current;g!==null&&h!==null&&g!==h&&(s(X({draggedIndex:g,droppedOverIndex:h})),p.current=null,f.current=null)},N=()=>{try{let o=JSON.parse(localStorage.getItem("forms")||"[]");const d=o.find(i=>i.id===m),g={title:r,description:n,fields:a};let h=m;if(m){const i=o.findIndex(u=>u.id===m);i>-1?(o[i]={...o[i],...g,updatedAt:new Date().toISOString(),fields:d!=null&&d.isTemplate?L(g.fields,o[i].originalTemplate):g.fields},console.log("Form updated successfully!")):(console.warn("Form not found for update, creating new one."),h=`form-${Date.now()}`,o.push({...g,id:h,createdAt:new Date().toISOString()}),console.log("New form created as fallback!"))}else h=`form-${Date.now()}`,o.push({...g,id:h,createdAt:new Date().toISOString()}),console.log("New form saved successfully!");return localStorage.setItem("forms",JSON.stringify(o)),{success:!0,formId:h}}catch(o){return console.error("Error saving form:",o),{success:!1,error:o.message}}},P=()=>{const o=N();o.success?l("/"):console.error("Failed to save form:",o.error)},Q=()=>{const o=N();o.success?l(`/form-preview/${o.formId}`):console.error("Failed to save form:",o.error)},L=(o,d)=>{if(!d)return o;const g=E[d];if(!g)return o;const h=g.fields.map(v=>v.id),i=o.filter(v=>h.includes(v.id));return[...g.fields.filter(v=>!i.find(w=>w.id===v.id)),...o]};return t.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-800 transition-colors",children:t.jsxs("div",{className:"container mx-auto px-4 py-8 dark:bg-gray-900 transition-colors",children:[t.jsx(Y,{}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[t.jsx("div",{className:"md:col-span-1",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 transition-colors",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-white transition-colors",children:"Form Elements"}),t.jsx(ee,{})]})}),t.jsx("div",{className:"md:col-span-3",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 min-h-[600px] transition-colors",onDragOver:b,onDrop:k,children:[t.jsx("input",{type:"text",value:r,onChange:o=>s(R({title:o.target.value})),placeholder:"Form Title",className:"w-full text-3xl font-bold mb-4 p-2 border-b-2 border-transparent focus:border-blue-500 focus:outline-none bg-transparent dark:text-white transition-colors"}),t.jsx("textarea",{value:n,onChange:o=>s(R({description:o.target.value})),placeholder:"Form Description",className:"w-full text-gray-600  mb-8 p-2 border-b-2 border-transparent focus:border-blue-500 focus:outline-none bg-transparent resize-none transition-colors dark:text-white",rows:"2"}),t.jsx(be,{questions:a,onQuestionDragStart:S,onQuestionDragOver:I,onQuestionDrop:T,onUpdateQuestion:(o,d)=>s(x({id:o,updates:d})),onRemoveQuestion:o=>s(A(o))}),t.jsxs("div",{className:"flex justify-end space-x-4 mt-8",children:[t.jsx("button",{onClick:P,className:"px-6 py-2 bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors",children:"Save Form"}),t.jsx("button",{onClick:Q,className:"px-6 py-2 bg-green-600 dark:bg-green-500 text-white rounded-lg hover:bg-green-700 dark:hover:bg-green-600 transition-colors",children:"Preview"})]})]})})]})]})})}export{je as F};
